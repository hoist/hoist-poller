[
  {
    "kind": "file",
    "static": true,
    "variation": null,
    "name": "lib/poller_service.js",
    "memberof": null,
    "longname": "lib/poller_service.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nimport _ from 'lodash';\nimport {\n  Subscription, Bucket, BouncerToken, ConnectorSetting\n}\nfrom '@hoist/model';\nimport SubscriptionWrapper from './subscription_wrapper';\nimport logger from '@hoist/logger';\nimport Bluebird from 'bluebird';\nimport fs from 'fs';\nimport config from 'config';\nimport path from 'path';\nimport {\n  Authorization\n}\nfrom '@hoist/connector-pipeline';\nimport EventsPipeline from '@hoist/events-pipeline';\nimport throat from 'throat';\nimport moment from 'moment';\n\nclass PollerService {\n  constructor() {\n    this._logger = logger.child({\n      cls: this.constructor.name\n    });\n    this._eventsPipeline = new EventsPipeline();\n  }\n  start() {\n    this._logger.info('starting poller service');\n    //mark as running\n    this.running = true;\n    //start poll\n    this._logger.info('starting loop');\n    this.loop = this.poll().cancellable();\n  }\n  stop() {\n    return Bluebird.try(() => {\n      this._logger.info('stopping poller service');\n      //mark as stopped\n      this.running = false;\n      //cancel loop\n      /* istanbul ignore else */\n      if (this.loop) {\n        if (this.loop.isCancellable()) {\n          this._logger.info('cancelling loop');\n          this.loop.cancel();\n        } else {\n          this._logger.warn('loop isn\\'t cancellable for some reason');\n        }\n        //delete loop\n        this._logger.info('deleting loop promise reference');\n        delete this.loop;\n      }\n    }, [], this);\n\n  }\n  poll() {\n    //load subscriptions\n    this._logger.info('loading subscriptions');\n    return this.loadSubscriptions()\n      .cancellable()\n      .bind(this)\n      //for each\n      .then((subscriptions) => {\n        this._logger.debug({\n          subscriptions: subscriptions\n        }, 'polling each subscription');\n        return _.map(subscriptions, throat(1, _.bind((subscription) => {\n          return this.pollSubscription(subscription);\n        }, this)));\n      })\n      //poll subscription\n      .then((pollPromises) => {\n        this._logger.info('settling all polls');\n        return Bluebird.settle(pollPromises).cancellable();\n      })\n      .then(() => {\n        //loop\n        /* istanbul ignore else */\n        if (this.running) {\n          this._logger.info('pausing');\n          return Bluebird.delay(1000)\n            .cancellable()\n            .bind(this)\n            .then(() => {\n              this._logger.info('looping');\n              return this.poll();\n            });\n        } else {\n          this._logger.info('poller stopped so stopping');\n        }\n      }).catch((err) => {\n        this._logger.error(err, 'error during poll loop');\n      });\n\n\n  }\n  loadSubscriptions() {\n\n    this.polledSubscriptions = this.polledSubscriptions || [];\n    var query = Subscription.findOneAndUpdate({\n        $and: [{\n          _id: {\n            $nin: _.clone(this.polledSubscriptions)\n          }\n        }, {\n          $or: [{\n            active: false\n          }, {\n            active: {\n              $exists: false\n            }\n          }]\n        }, {\n          $or: [{\n            nextPoll: {\n              $lt: moment().utc().toDate()\n            }\n          }, {\n            nextPoll: {\n              $exists: false\n            }\n          }]\n        }]\n      }, {\n        $set: {\n          active: true\n        }\n      })\n      .populate('application');\n    return Bluebird.resolve(query.exec()).then((result) => {\n      if (!result) {\n        this.polledSubscriptions = [];\n      } else {\n        this.polledSubscriptions.push(result._id);\n      }\n      return [].concat(result);\n    });\n  }\n  pollSubscription(subscription) {\n    this._logger.info({\n      subscription: subscription._id,\n      application: subscription.application._id\n    }, 'polling subscription');\n    return Promise.resolve().then(() => {\n        //wrap subscription\n        var context = {\n          subscription: new SubscriptionWrapper(subscription),\n          application: subscription.application\n        };\n\n        return context;\n      })\n      .then((context) => {\n        return ConnectorSetting.findOneAsync({\n          key: context.subscription._subscription.connector,\n          application: context.application._id,\n          environment: 'live'\n        }).then((connectorSettings) => {\n          context.connectorSettings = connectorSettings;\n          return context;\n        });\n      })\n      .then((context) => {\n        this._logger.debug({\n          context: context\n        }, 'setting context');\n        //load buckets\n        //load bouncer tokens based on buckets\n        var query = {\n          application: context.application._id,\n          environment: 'live'\n        };\n        //load only buckets with authTokens attached\n        query['meta.authToken.' + context.connectorSettings.key] = {\n          $exists: true\n        };\n        this._logger.info({\n          subscription: subscription._id,\n          application: subscription.application._id\n        }, 'finding all auth buckets');\n        return Bucket.findAsync(query)\n          .then((buckets) => {\n            this._logger.info({\n              buckets: _.pluck(buckets, '_id')\n            }, 'found buckets');\n            context.buckets = buckets;\n            return context;\n          });\n      }).then((context) => {\n        //for each bouncer token\n        //poll subscription\n        this._logger.info({\n          subscription: subscription._id,\n          application: subscription.application._id,\n          buckets: _.pluck(context.buckets, '_id')\n        }, 'polling all buckets');\n        var polls = _.map(context.buckets, throat(4, _.bind((bucket) => {\n          this._logger.info({\n            bucket: bucket._id\n          }, 'adding poll for bucket');\n          return this.pollContext(context, bucket);\n        }, this)));\n        polls.push(this.pollContext(context).catch((err) => {\n          console.log(err);\n          this._logger.error(err);\n        }));\n        return {\n          polls, context\n        };\n      }).then((result) => {\n        this._logger.info({\n          subscription: subscription._id,\n          application: subscription.application._id\n        }, 'settling root poll calls');\n        //also poll without a bucket for private connections\n        return Promise.all(result.polls).then(() => {\n          return result.context;\n        });\n      }).then((context) => {\n        //save changes to subscription\n        this._logger.info({\n          subscription: subscription._id,\n          application: subscription.application._id\n        }, 'saving updates to subscription');\n        context.subscription._subscription.active = false;\n        context.subscription._subscription.markModified('active');\n        return context.subscription.save();\n      });\n  }\n\n  pollContext(context, bucket) {\n    this._logger.info({\n      subscription: context.subscription._id,\n      application: context.application._id,\n      bucket: bucket ? bucket._id : /* istanbul ignore next */ null\n    }, 'polling context');\n    return Bluebird.resolve()\n      .then(() => {\n        /* istanbul ignore else */\n        if (bucket) {\n          this._logger.info({\n            bucket: bucket._id,\n            authToken: bucket.meta.authToken[context.connectorSettings.key]\n          }, 'polling with a bucket');\n          return BouncerToken.findOneAsync({\n            key: bucket.meta.authToken[context.connectorSettings.key]\n          });\n        } else {\n          this._logger.info('polling without a bucket');\n        }\n      }, [], this)\n      .then((bouncerToken) => {\n        var connectorsPath = path.resolve(config.get('Hoist.filePaths.connectors'));\n        var pollerPath = path.join(connectorsPath, context.connectorSettings.connectorType, 'current', 'lib/poll.js');\n        pollerPath = fs.realpathSync(pollerPath);\n        this._logger.debug({\n          path: pollerPath\n        }, 'loading poller');\n\n        var pollerMethod = require(pollerPath);\n        var pollContext = {\n          settings: context.connectorSettings.settings,\n          connectorKey: context.connectorSettings.key,\n          subscription: context.subscription,\n          application: context.application.toObject()\n        };\n        if (bouncerToken) {\n          this._logger.info('setting auth');\n          pollContext.authorization = new Authorization(bouncerToken);\n        }\n        if (bucket) {\n          this._logger.info('setting bucket');\n          pollContext.bucket = bucket.toObject();\n        }\n        this._logger.info({\n          application: pollContext.application._id\n        }, 'calling poll');\n        return pollerMethod(pollContext, (eventName, payload) => {\n          return this.raiseEvent(pollContext, eventName, payload);\n        }).then(() => {\n          this._logger.info({\n            application: pollContext.application._id\n          }, 'poll done');\n        });\n      }).catch((err) => {\n        console.log(err);\n        this._logger.error(err);\n      });\n  }\n  raiseEvent(context, eventName, payload) {\n    context.environment = 'live';\n    this._logger.debug({\n      context: context,\n      eventName: eventName,\n      payload: payload\n    }, 'raising event');\n    this._logger.info({\n      eventName: eventName,\n      application: context.application._id\n    }, 'raising event');\n\n    return this._eventsPipeline.raise(context, eventName, payload);\n  }\n}\n\n\nmodule.exports = PollerService;\n"
  },
  {
    "kind": "class",
    "static": true,
    "variation": null,
    "name": "PollerService",
    "memberof": "lib/poller_service.js",
    "longname": "lib/poller_service.js~PollerService",
    "access": null,
    "export": false,
    "importPath": "hoist-poller/lib/poller_service.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "interface": false
  },
  {
    "kind": "constructor",
    "static": false,
    "variation": null,
    "name": "constructor",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#constructor",
    "access": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "params": [],
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "_logger",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#_logger",
    "access": null,
    "description": null,
    "lineNumber": 23,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "_eventsPipeline",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#_eventsPipeline",
    "access": null,
    "description": null,
    "lineNumber": 26,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "start",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#start",
    "access": null,
    "description": null,
    "lineNumber": 28,
    "undocument": true,
    "params": [],
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "running",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#running",
    "access": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "loop",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#loop",
    "access": null,
    "description": null,
    "lineNumber": 34,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "stop",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#stop",
    "access": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "running",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#running",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "poll",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#poll",
    "access": null,
    "description": null,
    "lineNumber": 57,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "loadSubscriptions",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#loadSubscriptions",
    "access": null,
    "description": null,
    "lineNumber": 98,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "polledSubscriptions",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#polledSubscriptions",
    "access": null,
    "description": null,
    "lineNumber": 100,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "polledSubscriptions",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#polledSubscriptions",
    "access": null,
    "description": null,
    "lineNumber": 133,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "pollSubscription",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#pollSubscription",
    "access": null,
    "description": null,
    "lineNumber": 140,
    "undocument": true,
    "params": [
      {
        "name": "subscription",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "pollContext",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#pollContext",
    "access": null,
    "description": null,
    "lineNumber": 232,
    "undocument": true,
    "params": [
      {
        "name": "context",
        "types": [
          "*"
        ]
      },
      {
        "name": "bucket",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "raiseEvent",
    "memberof": "lib/poller_service.js~PollerService",
    "longname": "lib/poller_service.js~PollerService#raiseEvent",
    "access": null,
    "description": null,
    "lineNumber": 291,
    "undocument": true,
    "params": [
      {
        "name": "context",
        "types": [
          "*"
        ]
      },
      {
        "name": "eventName",
        "types": [
          "*"
        ]
      },
      {
        "name": "payload",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "file",
    "static": true,
    "variation": null,
    "name": "lib/subscription_wrapper.js",
    "memberof": null,
    "longname": "lib/subscription_wrapper.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nimport {\n  forOwn\n}\nfrom 'lodash';\n\nclass SubscriptionWrapper {\n  constructor(subscription) {\n    forOwn(subscription.toObject(), (n, key) => {\n      this[key] = n;\n    });\n    this._subscription = subscription;\n  }\n\n  get(key) {\n    /* istanbul ignore if */\n    if (!this._subscription.meta) {\n      return null;\n    }\n    return this._subscription.meta[key];\n  }\n  delayTill(dateTime) {\n    this._subscription.nextPoll = dateTime;\n  }\n  set(key, value) {\n    this._subscription.meta = this._subscription.meta || /* istanbul ignore next */ {};\n    this._subscription.meta[key] = value;\n    this._subscription.markModified('meta');\n  }\n  save() {\n    return this._subscription.saveAsync();\n  }\n}\n\nexport default SubscriptionWrapper;\n"
  },
  {
    "kind": "class",
    "static": true,
    "variation": null,
    "name": "SubscriptionWrapper",
    "memberof": "lib/subscription_wrapper.js",
    "longname": "lib/subscription_wrapper.js~SubscriptionWrapper",
    "access": null,
    "export": true,
    "importPath": "hoist-poller/lib/subscription_wrapper.js",
    "importStyle": "SubscriptionWrapper",
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "interface": false
  },
  {
    "kind": "constructor",
    "static": false,
    "variation": null,
    "name": "constructor",
    "memberof": "lib/subscription_wrapper.js~SubscriptionWrapper",
    "longname": "lib/subscription_wrapper.js~SubscriptionWrapper#constructor",
    "access": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "params": [
      {
        "name": "subscription",
        "types": [
          "*"
        ]
      }
    ],
    "generator": false
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "key",
    "memberof": "lib/subscription_wrapper.js~SubscriptionWrapper",
    "longname": "lib/subscription_wrapper.js~SubscriptionWrapper#key",
    "access": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "member",
    "static": false,
    "variation": null,
    "name": "_subscription",
    "memberof": "lib/subscription_wrapper.js~SubscriptionWrapper",
    "longname": "lib/subscription_wrapper.js~SubscriptionWrapper#_subscription",
    "access": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "get",
    "memberof": "lib/subscription_wrapper.js~SubscriptionWrapper",
    "longname": "lib/subscription_wrapper.js~SubscriptionWrapper#get",
    "access": null,
    "description": null,
    "lineNumber": 15,
    "undocument": true,
    "params": [
      {
        "name": "key",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "delayTill",
    "memberof": "lib/subscription_wrapper.js~SubscriptionWrapper",
    "longname": "lib/subscription_wrapper.js~SubscriptionWrapper#delayTill",
    "access": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "params": [
      {
        "name": "dateTime",
        "types": [
          "*"
        ]
      }
    ],
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "set",
    "memberof": "lib/subscription_wrapper.js~SubscriptionWrapper",
    "longname": "lib/subscription_wrapper.js~SubscriptionWrapper#set",
    "access": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "params": [
      {
        "name": "key",
        "types": [
          "*"
        ]
      },
      {
        "name": "value",
        "types": [
          "*"
        ]
      }
    ],
    "generator": false
  },
  {
    "kind": "method",
    "static": false,
    "variation": null,
    "name": "save",
    "memberof": "lib/subscription_wrapper.js~SubscriptionWrapper",
    "longname": "lib/subscription_wrapper.js~SubscriptionWrapper#save",
    "access": null,
    "description": null,
    "lineNumber": 30,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "generator": false
  },
  {
    "kind": "variable",
    "static": true,
    "variation": null,
    "name": "subscriptionWrapper",
    "memberof": "lib/subscription_wrapper.js",
    "longname": "lib/subscription_wrapper.js~subscriptionWrapper",
    "access": null,
    "export": true,
    "importPath": "hoist-poller/lib/subscription_wrapper.js",
    "importStyle": "subscriptionWrapper",
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "type": {
      "types": [
        "lib/subscription_wrapper.js~SubscriptionWrapper"
      ]
    }
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Infinity",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Infinity",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "NaN",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~NaN",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "undefined",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~undefined",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "null",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~null",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Object",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~object",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Function",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~function",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Boolean",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~boolean",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Symbol",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Symbol",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Error",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Error",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "EvalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~EvalError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "InternalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/InternalError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~InternalError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "RangeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~RangeError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "ReferenceError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~ReferenceError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "SyntaxError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~SyntaxError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "TypeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~TypeError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "URIError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~URIError",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Number",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~number",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Date",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Date",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "String",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~String",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "string",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~string",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "RegExp",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~RegExp",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Int8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int8Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int8Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Uint8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint8Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Uint8ClampedArray",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint8ClampedArray",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Int16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int16Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int16Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Uint16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint16Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Int32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int32Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Uint32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint32Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Float32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Float32Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Float64Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float64Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Float64Array",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Map",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Map",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Set",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Set",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "WeakMap",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~WeakMap",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "WeakSet",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~WeakSet",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "ArrayBuffer",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~ArrayBuffer",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "DataView",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~DataView",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "JSON",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~JSON",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Promise",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Promise",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Generator",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Generator",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "GeneratorFunction",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~GeneratorFunction",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Reflect",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Reflect",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Proxy",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Proxy",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "CanvasRenderingContext2D",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~CanvasRenderingContext2D",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "DocumentFragment",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~DocumentFragment",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Element",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Element",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~Element",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Event",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Event",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~Event",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "Node",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Node",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~Node",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "NodeList",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/NodeList",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~NodeList",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "external",
    "static": true,
    "variation": null,
    "name": "XMLHttpRequest",
    "externalLink": "https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "longname": "BuiltinExternal/WebAPIExternal.js~XMLHttpRequest",
    "access": null,
    "description": null,
    "builtinExternal": true
  },
  {
    "kind": "testFile",
    "static": true,
    "variation": null,
    "name": "tests/integration_tests/poller_integration_tests.js",
    "memberof": null,
    "longname": "tests/integration_tests/poller_integration_tests.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nimport PollerService from '../../lib/poller_service';\nimport Bluebird from 'bluebird';\nimport config from 'config';\nimport sinon from 'sinon';\nimport pollMethod from '../fixtures/test_connectors/hoist-connector-test/current/lib/poll';\nimport {\n  expect\n}\nfrom 'chai';\nimport {\n  Organisation,\n  Application,\n  ConnectorSetting,\n  Subscription,\n  _mongoose\n}\nfrom '@hoist/model';\n\n\nBluebird.promisifyAll(_mongoose);\ndescribe('Integration', () => {\n  describe('Polling a Subscription', () => {\n    before(() => {\n      return _mongoose.connectAsync(config.get('Hoist.mongo.core.connectionString'))\n        .then(() => {\n          return Promise.all([\n            new Organisation({\n              _id: 'org',\n              name: 'test-org',\n              slug: 'org'\n            }).saveAsync(),\n            new Application({\n              _id: 'app',\n              name: 'test-app',\n              slug: 'app',\n              organisation: 'org'\n            }).saveAsync(),\n            new ConnectorSetting({\n              _id: 'connector',\n              application: 'app',\n              environment: 'live',\n              name: 'test-connector',\n              connectorType: 'hoist-connector-test',\n              settings: {\n                something: true\n              },\n              key: 'test-connector-key'\n            }).saveAsync(),\n            new Subscription({\n              _id: 'subscription',\n              connector: 'test-connector-key',\n              endpoints: ['enpoint1'],\n              application: 'app',\n              environment: 'live',\n              nextPoll: new Date()\n            }).saveAsync()\n          ]).catch((err) => {\n            console.log(err);\n            throw err;\n          });\n        });\n    });\n    after(() => {\n      return Promise.all([\n        Organisation.removeAsync({}),\n        Application.removeAsync({}),\n        ConnectorSetting.removeAsync({}),\n        Subscription.removeAsync({})\n      ]).then(()=>{\n        return _mongoose.disconnectAsync();\n      });\n    });\n    describe('after poll has run', function () {\n      this.timeout(5000);\n      let pollerService;\n      let recievedSettings;\n      before(() => {\n        sinon.stub(pollMethod, 'process', (...settings) => {\n          recievedSettings = settings;\n          return Promise.resolve();\n        });\n        pollerService = new PollerService();\n        return Promise.resolve(pollerService.start())\n          .then(() => {\n            return Bluebird.delay(2000);\n          }).then(() => {\n            return pollerService.stop();\n          });\n      });\n      it('should mark subscription inactive', () => {\n        return Subscription.findOneAsync({}).then((subscription) => {\n          return expect(subscription.active).to.be.false;\n        });\n      });\n      it('passes settings to poll', () => {\n        return expect(recievedSettings[0].settings.something).to.eql(true);\n      });\n      after(() => {\n        pollMethod.process.restore();\n      });\n    });\n  });\n});\n"
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe0",
    "testId": 0,
    "memberof": "tests/integration_tests/poller_integration_tests.js",
    "testDepth": 0,
    "longname": "tests/integration_tests/poller_integration_tests.js~describe0",
    "access": null,
    "description": "Integration",
    "lineNumber": 22
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe1",
    "testId": 1,
    "memberof": "tests/integration_tests/poller_integration_tests.js~describe0",
    "testDepth": 1,
    "longname": "tests/integration_tests/poller_integration_tests.js~describe0.describe1",
    "access": null,
    "description": "Polling a Subscription",
    "lineNumber": 23
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe2",
    "testId": 2,
    "memberof": "tests/integration_tests/poller_integration_tests.js~describe0.describe1",
    "testDepth": 2,
    "longname": "tests/integration_tests/poller_integration_tests.js~describe0.describe1.describe2",
    "access": null,
    "description": "after poll has run",
    "lineNumber": 74
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it3",
    "testId": 3,
    "memberof": "tests/integration_tests/poller_integration_tests.js~describe0.describe1.describe2",
    "testDepth": 3,
    "longname": "tests/integration_tests/poller_integration_tests.js~describe0.describe1.describe2.it3",
    "access": null,
    "description": "should mark subscription inactive",
    "lineNumber": 91
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it4",
    "testId": 4,
    "memberof": "tests/integration_tests/poller_integration_tests.js~describe0.describe1.describe2",
    "testDepth": 3,
    "longname": "tests/integration_tests/poller_integration_tests.js~describe0.describe1.describe2.it4",
    "access": null,
    "description": "passes settings to poll",
    "lineNumber": 96
  },
  {
    "kind": "testFile",
    "static": true,
    "variation": null,
    "name": "tests/unit_tests/poller_service_tests.js",
    "memberof": null,
    "longname": "tests/unit_tests/poller_service_tests.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nimport PollerService from '../../lib/poller_service';\nimport sinon from 'sinon';\nimport {\n  expect\n}\nfrom 'chai';\nimport {\n  Subscription, ConnectorSetting, Bucket, Application, BouncerToken\n}\nfrom '@hoist/model';\nimport SubscriptionWrapper from '../../lib/subscription_wrapper';\nimport testPoller from '../fixtures/test_connectors/hoist-connector-test/current/lib/poll';\nimport EventPipeline from '@hoist/events-pipeline';\nimport moment from 'moment';\nimport Bluebird from 'bluebird';\n\ndescribe('PollerService', function () {\n  describe('#start', function () {\n\n    var pollerService = new PollerService();\n    before(function () {\n      sinon.stub(pollerService, 'poll').returns(Bluebird.delay(2000));\n      return pollerService.start();\n    });\n    it('marks service as running', function () {\n      return expect(pollerService.running).to.be.true;\n    });\n    it('calls poll', function () {\n      return expect(pollerService.poll)\n        .to.have.been.called;\n    });\n    it('saves running promise', function () {\n      return expect(pollerService.loop)\n        .to.exist;\n    });\n    it('marks promise as cancellable', function () {\n      return expect(pollerService.loop.isCancellable()).to.be.true;\n    });\n    after(function () {\n      pollerService.poll.restore();\n    });\n  });\n  describe('#stop', function () {\n    var pollerService = new PollerService();\n    var _error;\n    before(function () {\n      pollerService.running = true;\n\n      function loop() {\n        return Bluebird.delay(2000)\n          .then(function () {\n            return loop();\n          });\n      }\n      pollerService.loop = loop().cancellable().catch(function (err) {\n        _error = err;\n      });\n      pollerService.stop();\n\n    });\n    it('marks service as stopped', function () {\n      return expect(pollerService.running).to.be.false;\n    });\n    it('cancels loop', function () {\n      return expect(_error).to.be.instanceOf(Bluebird.CancellationError);\n    });\n    it('deletes loop', function () {\n      return expect(pollerService.loop).to.not.exist;\n    });\n  });\n  describe('#poll', function () {\n    var _subscription1 = {\n      subscription: 1\n    };\n    var _subscription2 = {\n      subscription: 2\n    };\n    var pollerService = new PollerService();\n    var _polled = 0;\n\n    before(function (done) {\n      pollerService.running = true;\n      sinon.stub(pollerService, 'loadSubscriptions').returns(Bluebird.resolve().then(function () {\n        return [_subscription1, _subscription2];\n      }));\n      sinon.stub(pollerService, 'pollSubscription').returns(Bluebird.resolve().then(function () {\n        return true;\n      }));\n      pollerService.originalPoll = pollerService.poll;\n      sinon.stub(pollerService, 'poll', function () {\n        _polled++;\n        if (_polled > 1) {\n          done();\n        } else {\n          return this.originalPoll();\n        }\n      });\n      return pollerService.poll();\n    });\n    it('loads all subscriptions', function () {\n      return expect(pollerService.loadSubscriptions)\n        .to.have.been.called;\n    });\n    it('polls each subscription', function () {\n      return expect(pollerService.pollSubscription)\n        .to.have.been.calledWith(_subscription1)\n        .and.to.have.been.calledWith(_subscription2);\n    });\n    it('loops', function () {\n      return expect(_polled).to.eql(2);\n    });\n  });\n  describe('#loadSubscriptions', function () {\n    var subscription = new Subscription({\n      _id: 'subscriptionid',\n      meta: {\n        subscription: 1\n      }\n    });\n    var _result;\n    var mockQuery = {\n      populate: sinon.stub(),\n      exec: sinon.stub()\n    };\n    var clock;\n    before(function () {\n      clock = sinon.useFakeTimers();\n      mockQuery.populate.returnsThis();\n      mockQuery.exec.returns(Promise.resolve(subscription));\n      var pollerService = new PollerService();\n      sinon.stub(Subscription, 'findOneAndUpdate').returns(mockQuery);\n      _result = pollerService.loadSubscriptions();\n\n    });\n    after(function () {\n      clock.restore();\n      Subscription.findOneAndUpdate.restore();\n    });\n    it('loads all subscriptions from the database', function () {\n      return expect(Subscription.findOneAndUpdate)\n        .to.have.been.calledWith({\n          $and: [{\n            _id: {\n              $nin: []\n            }\n          }, {\n            $or: [{\n              active: false\n            }, {\n              active: {\n                $exists: false\n              }\n            }]\n          }, {\n            $or: [{\n              nextPoll: {\n                $lt: moment().utc().toDate()\n              }\n            }, {\n              nextPoll: {\n                $exists: false\n              }\n            }]\n          }]\n        }, {\n          $set: {\n            active: true\n          }\n        });\n    });\n    it('should populate application', function () {\n      return expect(mockQuery.populate)\n        .to.have.been.calledWith('application');\n    });\n    it('returns subscriptions', function () {\n      return expect(_result).to.become([subscription]);\n    });\n  });\n  describe('#pollSubscriptions', function () {\n    var subscription = {\n      application: {\n        _id: 'application'\n      },\n      connector: 'connector',\n      toObject: sinon.stub().returnsThis(),\n      markModified: sinon.stub()\n    };\n    var connectorSetting = {\n      key: 'connector'\n    };\n    var buckets = [{\n      id: 1\n    }, {\n      id: 2\n    }];\n    var pollerService = new PollerService();\n    var contextMatcher = sinon.match(function (context) {\n      return context.subscription._subscription === subscription &&\n        context.application === subscription.application &&\n        context.connectorSettings === connectorSetting &&\n        context.buckets === buckets;\n    });\n    before(function () {\n      sinon.stub(ConnectorSetting, 'findOneAsync').returns(Promise.resolve(connectorSetting));\n      sinon.stub(Bucket, 'findAsync').returns(Promise.resolve(buckets));\n\n      sinon.stub(pollerService, 'pollContext').returns(Promise.resolve(null));\n      sinon.stub(SubscriptionWrapper.prototype, 'save').returns(Promise.resolve(null));\n      return pollerService.pollSubscription(subscription);\n    });\n    after(function () {\n      ConnectorSetting.findOneAsync.restore();\n      Bucket.findAsync.restore();\n      SubscriptionWrapper.prototype.save.restore();\n    });\n    it('loads connector settings', function () {\n      return expect(ConnectorSetting.findOneAsync)\n        .to.have.been.calledWith({\n          application: 'application',\n          environment: 'live',\n          key: 'connector'\n        });\n    });\n    it('loads buckets that have correct authentication tokens', function () {\n      return expect(Bucket.findAsync)\n        .to.have.been.calledWith({\n          application: 'application',\n          environment: 'live',\n          'meta.authToken.connector': {\n            $exists: true\n          }\n        });\n    });\n    it('polls every bucket', function () {\n      return expect(pollerService.pollContext)\n        .to.have.been.calledWith(contextMatcher, buckets[0])\n        .and.calledWith(contextMatcher, buckets[1]);\n    });\n    it('polls without a bucket', function () {\n      return expect(pollerService.pollContext)\n        .to.have.been.calledWithExactly(contextMatcher);\n    });\n    it('polls the correct number of times', function () {\n      return expect(pollerService.pollContext)\n        .to.have.been.calledThrice;\n    });\n    it('saves the subscription', function () {\n      return expect(SubscriptionWrapper.prototype.save)\n        .to.have.been.called;\n    });\n  });\n  describe('#pollContext', function () {\n    var pollerService = new PollerService();\n    var context = {\n      connectorSettings: {\n        connectorType: 'hoist-connector-test',\n        key: 'test-connector'\n      },\n      subscription: {\n        _id: 'subscription'\n      },\n      application: new Application()\n    };\n    var bucket = new Bucket({\n      meta: {\n        authToken: {\n          'test-connector': 'bouncerToken'\n        }\n      }\n    });\n    var bouncerToken = {};\n    before(function () {\n      sinon.stub(BouncerToken, 'findOneAsync').returns(Promise.resolve(bouncerToken));\n      sinon.stub(testPoller, 'process').returns(Promise.resolve(null));\n      sinon.stub(pollerService, 'raiseEvent').returns(null);\n      pollerService.pollContext(context, bucket);\n    });\n    after(function () {\n      testPoller.process.restore();\n      BouncerToken.findOneAsync.restore();\n    });\n    it('calls poller for connector', function () {\n      return expect(testPoller.process)\n        .to.have.been.called;\n    });\n    it('sends a raise event callback', function () {\n      var payload = {\n        payload: true\n      };\n      testPoller.process.getCall(0).args[1].call(null, 'eventname', payload);\n      return expect(pollerService.raiseEvent)\n        .to.have.been.calledWith(testPoller.process.getCall(0).args[0], 'eventname', payload);\n    });\n  });\n  describe('#raiseEvent', function () {\n    var pollerService = new PollerService();\n    var payload = {\n      payload: true\n    };\n    var context = {\n      bucket: {\n        bucket: true\n      },\n      application: {\n        application: true\n      }\n    };\n    before(function () {\n      sinon.stub(EventPipeline.prototype, 'raise').returns(Promise.resolve(null));\n      pollerService.raiseEvent(context, 'eventName', payload);\n    });\n    after(function () {\n      EventPipeline.prototype.raise.restore();\n    });\n    it('raises event', function () {\n      return expect(EventPipeline.prototype.raise)\n        .to.have.been.calledWith({\n          application: context.application,\n          bucket: context.bucket,\n          environment: 'live'\n        }, 'eventName', payload);\n    });\n  });\n});\n"
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe5",
    "testId": 5,
    "memberof": "tests/unit_tests/poller_service_tests.js",
    "testDepth": 0,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5",
    "access": null,
    "description": "PollerService",
    "lineNumber": 18
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe6",
    "testId": 6,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5",
    "testDepth": 1,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe6",
    "access": null,
    "description": "#start",
    "lineNumber": 19
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it7",
    "testId": 7,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe6",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe6.it7",
    "access": null,
    "description": "marks service as running",
    "lineNumber": 26
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it8",
    "testId": 8,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe6",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe6.it8",
    "access": null,
    "description": "calls poll",
    "lineNumber": 29
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it9",
    "testId": 9,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe6",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe6.it9",
    "access": null,
    "description": "saves running promise",
    "lineNumber": 33
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it10",
    "testId": 10,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe6",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe6.it10",
    "access": null,
    "description": "marks promise as cancellable",
    "lineNumber": 37
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe11",
    "testId": 11,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5",
    "testDepth": 1,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe11",
    "access": null,
    "description": "#stop",
    "lineNumber": 44
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it12",
    "testId": 12,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe11",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe11.it12",
    "access": null,
    "description": "marks service as stopped",
    "lineNumber": 62
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it13",
    "testId": 13,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe11",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe11.it13",
    "access": null,
    "description": "cancels loop",
    "lineNumber": 65
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it14",
    "testId": 14,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe11",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe11.it14",
    "access": null,
    "description": "deletes loop",
    "lineNumber": 68
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe15",
    "testId": 15,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5",
    "testDepth": 1,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe15",
    "access": null,
    "description": "#poll",
    "lineNumber": 72
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it16",
    "testId": 16,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe15",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe15.it16",
    "access": null,
    "description": "loads all subscriptions",
    "lineNumber": 101
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it17",
    "testId": 17,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe15",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe15.it17",
    "access": null,
    "description": "polls each subscription",
    "lineNumber": 105
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it18",
    "testId": 18,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe15",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe15.it18",
    "access": null,
    "description": "loops",
    "lineNumber": 110
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe19",
    "testId": 19,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5",
    "testDepth": 1,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe19",
    "access": null,
    "description": "#loadSubscriptions",
    "lineNumber": 114
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it20",
    "testId": 20,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe19",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe19.it20",
    "access": null,
    "description": "loads all subscriptions from the database",
    "lineNumber": 140
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it21",
    "testId": 21,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe19",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe19.it21",
    "access": null,
    "description": "should populate application",
    "lineNumber": 172
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it22",
    "testId": 22,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe19",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe19.it22",
    "access": null,
    "description": "returns subscriptions",
    "lineNumber": 176
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe23",
    "testId": 23,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5",
    "testDepth": 1,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe23",
    "access": null,
    "description": "#pollSubscriptions",
    "lineNumber": 180
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it24",
    "testId": 24,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe23",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe23.it24",
    "access": null,
    "description": "loads connector settings",
    "lineNumber": 217
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it25",
    "testId": 25,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe23",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe23.it25",
    "access": null,
    "description": "loads buckets that have correct authentication tokens",
    "lineNumber": 225
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it26",
    "testId": 26,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe23",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe23.it26",
    "access": null,
    "description": "polls every bucket",
    "lineNumber": 235
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it27",
    "testId": 27,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe23",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe23.it27",
    "access": null,
    "description": "polls without a bucket",
    "lineNumber": 240
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it28",
    "testId": 28,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe23",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe23.it28",
    "access": null,
    "description": "polls the correct number of times",
    "lineNumber": 244
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it29",
    "testId": 29,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe23",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe23.it29",
    "access": null,
    "description": "saves the subscription",
    "lineNumber": 248
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe30",
    "testId": 30,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5",
    "testDepth": 1,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe30",
    "access": null,
    "description": "#pollContext",
    "lineNumber": 253
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it31",
    "testId": 31,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe30",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe30.it31",
    "access": null,
    "description": "calls poller for connector",
    "lineNumber": 283
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it32",
    "testId": 32,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe30",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe30.it32",
    "access": null,
    "description": "sends a raise event callback",
    "lineNumber": 287
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe33",
    "testId": 33,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5",
    "testDepth": 1,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe33",
    "access": null,
    "description": "#raiseEvent",
    "lineNumber": 296
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it34",
    "testId": 34,
    "memberof": "tests/unit_tests/poller_service_tests.js~describe5.describe33",
    "testDepth": 2,
    "longname": "tests/unit_tests/poller_service_tests.js~describe5.describe33.it34",
    "access": null,
    "description": "raises event",
    "lineNumber": 316
  },
  {
    "kind": "testFile",
    "static": true,
    "variation": null,
    "name": "tests/unit_tests/subscription_wrapper_tests.js",
    "memberof": null,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js",
    "access": null,
    "description": null,
    "lineNumber": 1,
    "content": "'use strict';\nimport {\n  Subscription\n}\nfrom '@hoist/model';\nimport SubscriptionWrapper from '../../lib/subscription_wrapper';\nimport {\n  expect\n}\nfrom 'chai';\nimport sinon from 'sinon';\n\ndescribe('SubscriptionWrapper', function () {\n  var subscriptionWrapper;\n  var subscription;\n  describe('#get', function () {\n\n    before(function () {\n      subscription = new Subscription({\n        meta: {\n          existingKey: 'value'\n        }\n      });\n      subscriptionWrapper = new SubscriptionWrapper(subscription);\n    });\n    it('returns existing properties', function () {\n      return expect(subscriptionWrapper.get('existingKey')).to.eql('value');\n    });\n    it('returns undef if property doesn\\'t exist', function () {\n      return expect(subscriptionWrapper.get('nothing')).to.not.exist;\n    });\n  });\n  describe('#set', function () {\n    before(function () {\n      subscription = new Subscription({\n        meta: {\n          existingKey: 'value'\n        }\n      });\n      subscriptionWrapper = new SubscriptionWrapper(subscription);\n    });\n    it('updates existing properties', function () {\n      subscriptionWrapper.set('existingKey', 'newValue');\n      return expect(subscription.meta.existingKey).to.eql('newValue');\n    });\n    it('creates new properties', function () {\n      subscriptionWrapper.set('newKey', 'newValue');\n      return expect(subscription.meta.newKey).to.eql('newValue');\n    });\n  });\n  describe('#save', function () {\n    before(function () {\n      subscription = new Subscription({\n        meta: {\n          existingKey: 'value'\n        }\n      });\n      subscriptionWrapper = new SubscriptionWrapper(subscription);\n      sinon.stub(subscription, 'saveAsync').returns(Promise.resolve(null));\n      return subscriptionWrapper.save();\n    });\n    after(function () {\n      subscription.saveAsync.restore();\n    });\n    it('calls save on underlying subscription', function () {\n      return expect(subscription.saveAsync).to.have.been.called;\n    });\n  });\n});\n"
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe35",
    "testId": 35,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js",
    "testDepth": 0,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35",
    "access": null,
    "description": "SubscriptionWrapper",
    "lineNumber": 13
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe36",
    "testId": 36,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js~describe35",
    "testDepth": 1,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe36",
    "access": null,
    "description": "#get",
    "lineNumber": 16
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it37",
    "testId": 37,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe36",
    "testDepth": 2,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe36.it37",
    "access": null,
    "description": "returns existing properties",
    "lineNumber": 26
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it38",
    "testId": 38,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe36",
    "testDepth": 2,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe36.it38",
    "access": null,
    "description": "returns undef if property doesn't exist",
    "lineNumber": 29
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe39",
    "testId": 39,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js~describe35",
    "testDepth": 1,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe39",
    "access": null,
    "description": "#set",
    "lineNumber": 33
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it40",
    "testId": 40,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe39",
    "testDepth": 2,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe39.it40",
    "access": null,
    "description": "updates existing properties",
    "lineNumber": 42
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it41",
    "testId": 41,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe39",
    "testDepth": 2,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe39.it41",
    "access": null,
    "description": "creates new properties",
    "lineNumber": 46
  },
  {
    "kind": "testDescribe",
    "static": true,
    "variation": null,
    "name": "describe42",
    "testId": 42,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js~describe35",
    "testDepth": 1,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe42",
    "access": null,
    "description": "#save",
    "lineNumber": 51
  },
  {
    "kind": "testIt",
    "static": true,
    "variation": null,
    "name": "it43",
    "testId": 43,
    "memberof": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe42",
    "testDepth": 2,
    "longname": "tests/unit_tests/subscription_wrapper_tests.js~describe35.describe42.it43",
    "access": null,
    "description": "calls save on underlying subscription",
    "lineNumber": 65
  }
]